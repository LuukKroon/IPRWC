<div class="container mx-auto p-4">
  <h1 class="text-3xl font-bold mb-6 text-blue-800">Productoverzicht</h1>

  <div class="relative mb-4">
    
    <button *ngIf="showLeftScroll" 
            (click)="scrollCategories(-250)"
            class="absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white shadow-lg border border-gray-100 text-blue-700 rounded-full w-10 h-10 flex items-center justify-center transition-all duration-300 hover:bg-blue-50 hover:scale-110 focus:outline-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
      </svg>
    </button>

    <div #categoryList 
         (scroll)="checkScrollStatus()"
         class="flex gap-4 overflow-x-auto py-4 px-8 snap-x hide-scrollbar scroll-smooth">
      
      <button (click)="selectCategory('all')"
              [ngClass]="selectedCategoryId === 'all' ? 'bg-blue-900 ring-4 ring-blue-300 scale-105 shadow-lg' : 'bg-blue-600 hover:bg-blue-700'"
              class="flex-shrink-0 flex items-center justify-center min-w-[140px] h-24 px-4 text-white font-bold rounded-xl shadow-sm transition-all duration-300 cursor-pointer snap-start">
        <span>Alle Producten</span>
      </button>

      <button *ngFor="let cat of categories" 
              (click)="selectCategory(cat.id!)"
              [ngClass]="selectedCategoryId === cat.id ? 'bg-blue-900 ring-4 ring-blue-300 scale-105 shadow-lg' : 'bg-blue-600 hover:bg-blue-700'"
              class="flex-shrink-0 flex flex-col items-center justify-center min-w-[140px] h-24 px-4 text-white rounded-xl shadow-sm transition-all duration-300 cursor-pointer snap-start">
        <span class="font-bold text-lg text-center">{{ cat.naam }}</span>
        <span *ngIf="cat.beschrijving" class="text-xs text-blue-100 mt-1 text-center line-clamp-1">
          {{ cat.beschrijving }}
        </span>
      </button>
    </div>

    <button *ngIf="showRightScroll" 
            (click)="scrollCategories(250)"
            class="absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white shadow-lg border border-gray-100 text-blue-700 rounded-full w-10 h-10 flex items-center justify-center transition-all duration-300 hover:bg-blue-50 hover:scale-110 focus:outline-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>

  <div class="flex justify-end bg-gray-50 p-3 rounded-lg mb-8 border border-gray-200 shadow-sm">
    <div class="flex items-center">
      <label class="font-bold mr-3 text-gray-700">Sorteer op:</label>
      <select [(ngModel)]="sortOption" (change)="applyFiltersAndSort()" 
              class="border border-gray-300 rounded-md p-2 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">
        <option value="default">Aanbevolen</option>
        <option value="priceAsc">Prijs: Laag naar Hoog</option>
        <option value="priceDesc">Prijs: Hoog naar Laag</option>
      </select>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
    <div *ngFor="let product of filteredProducts" class="border rounded-xl shadow-md overflow-hidden bg-white relative hover:shadow-xl transition-shadow duration-300">
      
      <div *ngIf="getActiveOffer(product) as offer" 
           class="absolute top-3 right-3 bg-red-600 text-white font-black text-sm py-1.5 px-3 rounded-full z-10 shadow-sm border-2 border-white transform rotate-3">
        -{{ offer.kortingsPercentage }}%
      </div>

      <a [routerLink]="['/product', product.id]" class="block cursor-pointer overflow-hidden bg-gray-100">
        <img [src]="getProductImageUrl(product.id)" 
             alt="{{ product.naam }}" 
             class="w-full h-48 object-cover hover:scale-105 transition-transform duration-500">
      </a>

      <div class="p-5">
        <a [routerLink]="['/product', product.id]" class="cursor-pointer text-gray-800 hover:text-blue-600 transition-colors">
          <h2 class="text-lg font-bold truncate">{{ product.naam }}</h2>
        </a>
        
        <p class="text-gray-500 mt-1 text-sm line-clamp-2 min-h-[40px]">{{ product.beschrijving }}</p>
        
        <div class="flex justify-between items-end mt-4">
          <div class="flex flex-col">
            <span *ngIf="getActiveOffer(product)" class="line-through text-gray-400 text-xs font-semibold">
              € {{ product.prijs | number:'1.2-2' }}
            </span>
            <span class="text-xl font-black" [ngClass]="getActiveOffer(product) ? 'text-red-600' : 'text-gray-900'">
              € {{ getCurrentPrice(product) | number:'1.2-2' }}
            </span>
          </div>
          
          <button (click)="addToCart(product)" 
                  class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow transition transform hover:scale-110 active:scale-95 flex items-center gap-2">
            + 
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <div *ngIf="filteredProducts.length === 0" class="text-center text-gray-500 py-20">
    <p class="text-xl font-medium">Geen producten gevonden in deze categorie.</p>
  </div>
</div>